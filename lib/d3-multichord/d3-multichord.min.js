!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-array"),require("d3-path")):"function"==typeof define&&define.amd?define(["exports","d3-array","d3-path"],t):t(n.d3=n.d3||{},n.d3,n.d3)}(this,function(n,t,r){"use strict";function e(n){return function(t,r){return n(t.source.value+t.target.value,r.source.value+r.target.value)}}function u(){function n(n){var e,i,l,s,c,f,p,h=n.length,g=n[0][0].length,d={},m=t.range(h),A=[],x=[],b=x.groups=new Array(h),M=x.subgroups=new Array(h*h);for(e=0,f=-1;++f<h;){for(d[f]||(d[f]={}),l=0,p=-1;++p<h;)d[p]||(d[p]={}),l+=t.sum(n[f][p]),d[f].in?d[f].in+=t.sum(n[f][p]):d[f].in=t.sum(n[f][p]),d[p].out?d[p].out+=t.sum(n[f][p]):d[p].out=t.sum(n[f][p]);A.push(t.range(h)),e+=l}for(u&&m.sort(function(n,t){return u(d[n].in,d[t].in)}),o&&A.forEach(function(r,e){r.sort(function(r,u){return o(t.sum(n[e][r]),t.sum(n[e][u]))})}),e>0&&(e=v(0,y-r*h)/e),c=e?r:y/h,l=0,f=-1;++f<h;){for(s=l,p=-1;++p<h;){var q=m[f],_=A[q][p],w=t.sum(n[q][_]),C=l;for(l+=w*e,M[_*h+q]=new Array(g),i=-1;++i<g;){w=n[q][_][i];var P=C,T=C+=w*e;M[_*h+q][i]={index:q,subindex:_,startAngle:P,endAngle:T,value:w,category:i}}}b[q]={index:q,startAngle:s,endAngle:l,value:{in:d[q].in,out:d[q].out}},l+=c}for(f=-1;++f<h;)for(p=f-1;++p<h;)for(i=-1;++i<g;){var j=M[p*h+f][i],E=M[f*h+p][i];(j.value||E.value)&&x.push(j.value<E.value?{source:E,target:j}:{source:j,target:E})}return a?x.sort(a):x}var r=0,u=null,o=null,a=null;return n.padAngle=function(t){return arguments.length?(r=v(0,t),n):r},n.sortGroups=function(t){return arguments.length?(u=t,n):u},n.sortSubgroups=function(t){return arguments.length?(o=t,n):o},n.sortChords=function(t){return arguments.length?(null==t?a=null:(a=e(t))._=t,n):a&&a._},n}function o(n){return function(){return n}}function a(n){return n.source}function i(n){return n.target}function l(n){return n.radius}function s(n){return n.startAngle}function c(n){return n.endAngle}function f(){function n(){var n,o=m.call(arguments),a=t.apply(this,o),i=e.apply(this,o),l=+u.apply(this,(o[0]=a,o)),s=f.apply(this,o)-d,c=g.apply(this,o)-d,v=l*p(s),A=l*h(s),x=+u.apply(this,(o[0]=i,o)),b=f.apply(this,o)-d,M=g.apply(this,o)-d;if(y||(y=n=r.path()),y.moveTo(v,A),y.arc(0,0,l,s,c),s===b&&c===M||(y.quadraticCurveTo(0,0,x*p(b),x*h(b)),y.arc(0,0,x,b,M)),y.quadraticCurveTo(0,0,v,A),y.closePath(),n)return y=null,n+""||null}var t=a,e=i,u=l,f=s,g=c,y=null;return n.radius=function(t){return arguments.length?(u="function"==typeof t?t:o(+t),n):u},n.startAngle=function(t){return arguments.length?(f="function"==typeof t?t:o(+t),n):f},n.endAngle=function(t){return arguments.length?(g="function"==typeof t?t:o(+t),n):g},n.source=function(r){return arguments.length?(t=r,n):t},n.target=function(t){return arguments.length?(e=t,n):e},n.context=function(t){return arguments.length?(y=null==t?null:t,n):y},n}var p=Math.cos,h=Math.sin,g=Math.PI,d=g/2,y=2*g,v=Math.max,m=Array.prototype.slice;n.multichord=u,n.ribbon=f,Object.defineProperty(n,"__esModule",{value:!0})});